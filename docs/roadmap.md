# Roadmap and Progress

最終更新: 2026-01-11

このドキュメントは、Simple Docking Dashboard プロジェクトの開発ロードマップと実装進捗を管理します。

## ✅ 完了済み (Completed)

### v0.1 - MVP基盤構築

#### インフラストラクチャ
- [x] Docker Compose 環境構築
- [x] PostgreSQL 16 データベース
- [x] Valkey/Redis 7 メッセージブローカー
- [x] Nginx ゲートウェイ（port 8090）
- [x] サブパス対応（`/simple-docking`）

#### バックエンド（FastAPI）
- [x] RESTful API 基盤
- [x] データベースモデル（Ligand, Protein, Run, Task）
- [x] API エンドポイント実装
  - [x] リガンド管理（作成・取得）
  - [x] タンパク質一覧取得
  - [x] 実行管理（作成・ステータス・結果）
  - [x] タスク管理（取得・キャンセル）
  - [x] 実行キャンセル
  - [x] 結果エクスポート
  - [x] ファイル配信（成果物・タンパク質）
- [x] ヘルスチェックエンドポイント
- [x] OpenAPI ドキュメント自動生成

#### ワーカー（Celery）
- [x] Celery 分散タスクキュー
- [x] ドッキングパイプライン実装（`worker/app/pipeline.py`）
- [x] RDKit による 3D 構造生成
- [x] Meeko による PDBQT 変換
- [x] AutoDock Vina サブプロセス実行
- [x] タスク状態管理（pending → running → completed/failed）
- [x] エラーハンドリングとログ記録

#### フロントエンド（React + Vite）
- [x] 4ステップウィザード UI
  - [x] InputPage: リガンド入力（SMILES/Molfile）
  - [x] TargetsPage: タンパク質選択
  - [x] SettingsPage: ドッキング設定
  - [x] ResultsPage: 結果表示
- [x] DashboardPage: 実行履歴一覧
- [x] ナビゲーション機能
- [x] 結果ダウンロード機能
- [x] レスポンシブデザイン

### v0.2 - 実ドッキング計算の実装

#### 分子ドッキング
- [x] AutoDock Vina 実計算エンジン統合
  - [x] subprocess 経由での Vina 実行
  - [x] 正規表現によるスコア抽出
  - [x] エラーハンドリング（CalledProcessError）
- [x] PDBQT 準備パイプライン
  - [x] RDKit 分子操作と検証
  - [x] Meeko 統合
  - [x] 失敗時の詳細エラーメッセージ

#### タンパク質ライブラリ
- [x] 5つの実キナーゼ構造追加
  - [x] CDK2 (PDB:1M17) - 細胞周期調節、がん標的
  - [x] EGFR (PDB:4I23) - 上皮成長因子受容体
  - [x] Src (PDB:2SRC) - がん原遺伝子
  - [x] PKA (PDB:1ATP) - シグナル伝達
  - [x] ABL (PDB:1IEP) - 白血病標的（Gleevec）
- [x] PDB リガンドからの結合部位自動検出
- [x] 結合ボックスパラメータ自動計算
- [x] manifest.json による管理

### v0.3 - セキュリティと運用機能

#### セキュリティ強化
- [x] CORS 設定（制限的デフォルト: localhost:8090, localhost:3000）
- [x] レート制限（60 req/min）- slowapi 使用
- [x] 入力バリデーション（SMILES/Molfile サイズ制限）
- [x] 単一外部エンドポイント化（port 8090 のみ）
- [x] PostgreSQL/Redis ポート非公開（Docker 内部ネットワークのみ）

#### 運用機能
- [x] 構造化ログ実装（API エンドポイント全体）
- [x] 詳細エラーメッセージ
- [x] ワーカーログの包括的記録
- [x] タスク/実行キャンセル機能
  - [x] Celery タスク revoke（terminate シグナル）
  - [x] キャンセル用 API エンドポイント

#### 依存関係管理
- [x] uv による依存関係固定（`uv.lock`）
- [x] Worker segfault 修正（互換性のある依存バージョン）
- [x] slowapi==0.1.9 追加

### v0.4 - デプロイメント対応

#### ドキュメント
- [x] デプロイメントノート作成（`docs/deploy.md`）
- [x] README 更新（実 Vina 実装反映）
- [x] アーキテクチャドキュメント（`docs/architecture.md`）
- [x] ライセンス情報（`docs/licenses.md`）
- [x] Agent ガイドライン（`AGENTS.md`）
- [x] ユーザーマニュアル（`docs/USER_GUIDE.md`）
- [x] Agent Skills 実装
  - [x] `documentation-sync`: ドキュメント自動更新
  - [x] `doc-consistency`: AGENTS.md と CLAUDE.md の整合性チェック
  - [x] `api-endpoint`: API エンドポイント追加支援
  - [x] `user-manual`: ユーザーマニュアル生成・更新

#### 開発ワークフロー
- [x] 開発用 DB/Redis アクセス手順
- [x] テスト実行環境（pytest）
- [x] タンパク質ライブラリ更新スクリプト
- [x] ブランチ戦略のドキュメント化（main/develop フロー）

### v0.5 - UI 改善とエディタ統合

#### Ketcher 分子エディタ統合
- [x] Ketcher React コンポーネント統合
- [x] グラフィカルな2D分子入力UI
- [x] エディタからSMILES形式での出力
- [x] React forwardRef 問題の修正（onInit コールバック使用）
- [x] Node.js polyfills 追加（process.env, global）
- [x] Vite 設定の最適化

#### 結合部位検出の改善
- [x] PDB リガンドからの結合部位自動検出（完全実装）
- [x] 結合ボックスパラメータ自動計算
- [x] manifest.json への反映

#### ユーザビリティ改善
- [x] start.sh スクリプトによる起動支援
- [x] ブラウザ自動起動機能
- [x] ヘルスチェック機能の改善

### v0.6 - 環境設定とカスタマイズ

#### 環境設定機能
- [x] `.env` による環境変数カスタマイズ
  - [x] `.env.example` テンプレートファイル
  - [x] ポート番号変更（`EXTERNAL_PORT`）
  - [x] データベース設定（パスワード、ユーザー名、DB名）
  - [x] タスク設定（タイムアウト、リトライ回数）
  - [x] ドッキング設定（ポケット検出方法、パディング）
  - [x] セキュリティ設定（CORS、レート制限）
- [x] 環境設定ドキュメント（`docs/configuration.md`）
  - [x] 設定項目の詳細説明
  - [x] 使用例（開発環境、本番環境）
  - [x] トラブルシューティング
  - [x] セキュリティベストプラクティス

#### UI/UX 改善
- [x] クリック可能なヘッダータイトル
  - [x] タイトルクリックでダッシュボードに戻る機能
  - [x] ナビゲーション体験の向上
- [x] UIスクリーンショット追加
  - [x] ユーザーガイド用の画面キャプチャ
  - [x] 各ステップのビジュアル説明

### v0.7 - オンプレミスデプロイメント対応

#### デプロイメント
- [x] オンプレミスデプロイ手順の詳細化
  - [x] 基本的なデプロイ手順（`docs/deploy.md`）
  - [x] 環境設定の統合（`.env` による柔軟な設定）
  - [x] データ永続化の説明
- [x] プロダクション環境設定
  - [x] セキュリティ設定（CORS、レート制限、ポート制限）
  - [x] パスワード変更手順
  - [x] HTTPS/TLS対応（Caddy例）

## 🚧 進行中 (In Progress)

現在、機能拡張フェーズに入っています。以下の項目から優先的に実装を進めます。

### v0.8 - 機能拡張

#### タンパク質ライブラリ拡充（優先度：高）
- [ ] タンパク質カテゴリの追加
  - [ ] GPCR（G タンパク質共役受容体）
  - [ ] プロテアーゼ
  - [ ] 核内受容体
- [ ] カスタムタンパク質アップロード機能
- [ ] PDB から直接インポート機能

#### 結果可視化（優先度：高）
- [ ] 3D 分子ビューワー統合（NGL Viewer / 3Dmol.js）
- [ ] インタラクション図の自動生成
- [ ] ドッキングポーズのアニメーション
- [ ] スコア分布グラフ

#### バッチ処理（優先度：中）
- [ ] 複数リガンド一括ドッキング
- [ ] CSV/SDF ファイルアップロード
- [ ] バッチジョブ管理 UI
- [ ] 結果の一括ダウンロード

## 📋 計画中 (Planned)

### v0.9 - 高度な機能

#### ドッキング計算の拡張
- [ ] 柔軟性ドッキング（タンパク質側鎖の柔軟性）
- [ ] 複数コンフォメーション生成
- [ ] スコアリング関数の選択肢追加
- [ ] カスタムパラメータ設定 UI

#### 監視とログ
- [ ] ジョブキュー監視ダッシュボード
- [ ] Prometheus メトリクス出力
- [ ] Grafana ダッシュボード
- [ ] アラート設定

#### API 改善
- [ ] API バージョニング（v1, v2）
- [ ] GraphQL エンドポイント
- [ ] WebSocket によるリアルタイム更新
- [ ] Webhook 通知

## 💡 検討中 (Under Consideration)

### クラウド/マルチユーザー環境向け機能

オンプレミス単一ユーザー環境では不要ですが、将来的にクラウドやマルチユーザー環境で運用する場合に検討する項目です。

#### 認証・認可
- [ ] ユーザー認証システム
- [ ] API キー認証
- [ ] ロールベースアクセス制御（RBAC）
- [ ] セッション管理

#### クラウドデプロイ
- [ ] クラウドデプロイ対応（AWS/GCP/Azure）
- [ ] Kubernetes 対応
- [ ] Docker イメージ最適化
- [ ] コンテナレジストリ統合

### 技術的改善
- [ ] フロントエンドの TypeScript 移行
- [ ] E2E テストの導入（Playwright / Cypress）
- [ ] CI/CD パイプライン構築（GitHub Actions）

### パフォーマンス最適化
- [ ] データベースクエリ最適化
- [ ] Redis キャッシュ戦略
- [ ] ワーカーの水平スケーリング
- [ ] CDN 統合（静的アセット配信）

### ユーザビリティ
- [ ] チュートリアル・ウォークスルー
- [ ] サンプルリガンドライブラリ
- [ ] 多言語対応（国際化）
- [ ] アクセシビリティ改善（WCAG 準拠）

### 研究機能
- [ ] ドッキングスコアの統計分析
- [ ] 構造類似性検索
- [ ] 薬物様性質（Lipinski's Rule）の自動評価
- [ ] ADMET 予測統合

### インテグレーション
- [ ] ChEMBL データベース連携
- [ ] PubChem 検索統合
- [ ] Jupyter Notebook サポート
- [ ] Python SDK 提供

## 制限事項と既知の問題

### 現在の制限
- **想定環境**: オンプレミス単一ユーザー環境（認証・認可は未実装）
- **タンパク質ライブラリ**: キナーゼ 5 件のみ（拡充予定）
- **3D ビューワー**: 未実装（結果はダウンロードして外部ツールで確認）
- **バッチ処理**: 未対応（1リガンド×複数タンパク質のみ）
- **多言語対応**: 日本語のみ

### 既知の問題
- なし（現時点で重大な問題は報告されていません）

## 開発統計

- **総コミット数**: 25
- **アクティブブランチ**: 2（main, develop）
- **API エンドポイント**: 14
- **タンパク質ライブラリ**: 5 キナーゼ構造
- **フロントエンドページ**: 5（Dashboard + 4 ステップウィザード）
- **Agent Skills**: 4（documentation-sync, doc-consistency, api-endpoint, user-manual）
- **ドキュメント**: 7（README, architecture, roadmap, deploy, USER_GUIDE, configuration, protein_library）

## 次のマイルストーン

現在 v0.8（機能拡張）フェーズに入っています。以下の優先順位で実装を進めます。

### 短期目標（v0.8）

1. **タンパク質ライブラリ拡充**（優先度：高）
   - GPCR、プロテアーゼ、核内受容体などの追加
   - PDB からの直接インポート機能
   - カスタムタンパク質アップロード機能

2. **結果可視化の強化**（優先度：高）
   - 3D 分子ビューワー統合（NGL Viewer / 3Dmol.js）
   - インタラクション図の自動生成
   - スコア分布グラフの実装

3. **バッチ処理対応**（優先度：中）
   - 複数リガンド一括ドッキング
   - CSV/SDF ファイルアップロード
   - バッチジョブ管理 UI

### 長期目標（v0.9以降）

- ドッキング計算の拡張（柔軟性ドッキング、複数コンフォメーション）
- 監視とログの強化（ジョブキュー監視、メトリクス）
- API 改善（バージョニング、WebSocket）

---

**Note**: このドキュメントは Agent Skill (`documentation-sync`) により自動更新されます。
手動で追加した情報は保持されますが、自動生成セクションは上書きされる可能性があります。
